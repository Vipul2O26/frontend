<br>
<div class="container-fluid py-4">
  <div class="row">
    <!-- ğŸ“‹ Left: Main Content (Task Dashboard) -->
    <div class="col-lg-9">
      <!-- Title -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">ğŸ“‹ Task Dashboard</h2>
      </div>

      <!-- Task Table -->
      <div class="card shadow-sm border-0 mb-4">
        <div class="card-body table-responsive p-0">
          <table class="table table-hover align-middle mb-0 w-100">
            <thead class="table-light text-center">
              <tr>
                <th>Title</th>
                <th>Priority</th>
                <th>Due Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let task of tasks()">
                <td>{{ task.title }}</td>
                <td>
                  <span class="badge rounded-pill"
                        [ngClass]="{
                          'bg-danger': task.priority === 'High',
                          'bg-warning text-dark': task.priority === 'Medium',
                          'bg-success': task.priority === 'Low'
                        }">
                    {{ task.priority }}
                  </span>
                </td>
                <td>{{ task.dueDate | date: 'mediumDate' }}</td>
                <td>
                  <span class="badge rounded-pill"
                        [ngClass]="{
                          'bg-success': task.isCompleted,
                          'bg-secondary': !task.isCompleted
                        }">
                    {{ task.isCompleted ? 'Completed' : 'Pending' }}
                  </span>
                </td>
                <td class="text-center">
                  <a [routerLink]="['/task-form']"
                     [queryParams]="{ id: task.id }"
                     class="btn btn-sm btn-outline-primary me-2">âœï¸ Edit</a>
                  <button class="btn btn-sm btn-outline-danger me-2" (click)="deleteTask(task.id)">ğŸ—‘ï¸ Delete</button>
                  <button *ngIf="!task.isCompleted"
                          class="btn btn-sm btn-outline-success"
                          (click)="markAsComplete(task.id)">âœ… Complete</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- ğŸ“Š Pie Chart -->
      <div class="card shadow-sm text-center p-4 mb-4">
        <h4 class="mb-3">ğŸ“Š Task Priority Distribution</h4>
        <div style="width: 250px; height: 250px; margin: auto;">
          <canvas id="taskChart"></canvas>
        </div>
      </div>
    </div>

    <!-- ğŸ“… Right: Sidebar (Calendar) -->
    <div class="col-lg-3 mt-5 mt-lg-0">
      <div class="bg-white border rounded shadow-sm p-3 mb-4">
        <app-calendar></app-calendar>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ” Confirmation Modal -->
<div class="modal fade show d-block" *ngIf="showModal" style="background: rgba(0, 0, 0, 0.5)">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirm Delete</h5>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this task?</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="cancelDelete()">Cancel</button>
        <button class="btn btn-danger" (click)="deleteConfirmed()">Delete</button>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ”” Toast Notification -->
<div class="toast show position-fixed bottom-0 end-0 m-4 text-bg-danger"
     *ngIf="showToast"
     style="z-index: 1055">
  <div class="d-flex">
    <div class="toast-body">{{ toastMessage }}</div>
    <button type="button"
            class="btn-close btn-close-white me-2 m-auto"
            (click)="showToast = false"></button>
  </div>
</div>

<!-- â¬‡ï¸ Footer -->
<app-header></app-header>
<app-footer></app-footer>